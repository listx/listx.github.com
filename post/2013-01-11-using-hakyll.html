<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Linus's Blog - Using Hakyll with GitHub Pages</title>
		<link rel="stylesheet" href="../css/base.css">
		<link rel="stylesheet" href="../css/syntax.css">
		<link href="http://fonts.googleapis.com/css?family=Merriweather:400,400italic,700italic,700" rel="stylesheet" type="text/css">
		<link rel="shortcut icon" type="image/png" href="../favicon.png">
		
	</head>
	<body>
		<div id="header">
			<a href="../">Home</a>
			&bull;
			<a href="../about.html">About</a>
			&bull;
			<a href="../art.html">Art</a>
			&bull;
			<a href="../code.html">Code</a>
			&bull;
			<a href="../archive.html">Archive</a>
		</div>

		<div id="content">
			<h1 class="center">Using Hakyll with GitHub Pages</h1>

			<div class="info center"><code>2013-01-11</code></div>
<div class="info center"><a href="../tag/linux.html">linux</a>, <a href="../tag/hakyll.html">hakyll</a>, <a href="../tag/github.html">github</a></div>

<p>I decided to ditch wordpress.com, because:</p>
<ul>
<li>I cringe every time I have to use their web GUI for adding new posts.</li>
<li>I don’t <em>really</em> need to use all of the features that come with a free wordpress blog.</li>
<li>Wordpress automatically puts in hard line breaks… this is so annoying. For one thing, I like to type one sentence per line in plain text, because then if I do a revision, the (git) diff looks very, very clear and sexy. In fact, this is how I write all of my LaTeX files. But with Wordpress’s forced line breaks, I have to manually join all the lines before submitting it into the New Post text dialog box. Annoying.</li>
<li>I want to use git to track my blog posts because they are quite valuable to me and a lot of other people.</li>
</ul>
<p>Now, why choose <a href="http://jaspervdj.be/hakyll/">Hakyll</a>? I chose it because it’s the only Haskell static site generator out there with real users and active development. Granted, the road to using Hakyll was very difficult, because right now actually it is in a transition stage to the new Hakyll version 4. However, the hurdles were well worth it.</p>
<p>My system is Arch Linux.</p>
<h2 id="install-cabal">Install cabal</h2>
<p>First, we need to install the <code>cabal-install</code> package from the [extra] repo.</p>
<pre><code>sudo pacman -S cabal-install</code></pre>
<h2 id="install-hsenv-with-cabal">Install hsenv with cabal</h2>
<p>Now we need to install <code>hsenv</code>. <code>hsenv</code> is neat because it allows you to have a sandboxed cabal/haskell/ghc environment on a per-shell-session basis. The biggest dependency is <code>pandoc</code>, which actually fails to install using plain <code>cabal</code>; not to worry, because [extra] already has the <code>haskell-pandoc</code> package.</p>
<pre><code>sudo pacman -S haskell-pandoc</code></pre>
<p>Now we install <code>hsenv</code>. We use the forked version from <a href="https://github.com/tmhedberg/hsenv">tmhedberg’s repo</a> because the <a href="https://github.com/Paczesiowa/hsenv">original maintainer’s repo</a> has been suffering from bitrot for a few months now (the original maintainer has disappeared).</p>
<table class="sourceCode bash numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
</pre></td><td class="sourceCode"><pre><code class="sourceCode bash"><span class="kw">git</span> clone --depth 1 git://github.com/tmhedberg/hsenv.git
<span class="kw">cd</span> hsenv
<span class="kw">cabal</span> install</code></pre></td></tr></table>
<h2 id="download-hakyll-and-install-it-with-hsenv-for-your-new-blog">Download hakyll and install it with hsenv for your new blog</h2>
<p>Now we need to get the latest <code>hakyll</code>. I decided to check out the <code>hakyll4</code> branch because from what I can tell this version allows you to do painless syntax highlighting with <code>pandoc</code>. You could just use the regular <code>master</code> branch (hakyll 3.x) but syntax highlighting support on code blocks is a pain; plus, you’re going to have to migrate to hakyll 4 later anyway, so just use <code>hakyll4</code>.</p>
<pre><code>git clone --depth 1 -b hakyll4 http://github.com/jaspervdj/hakyll.git</code></pre>
<p>The hakyll4 repo has several working sample blog sites. Now go into the just-cloned hakyll repo, and copy the contents of the <code>data/example</code> folder to your new blog’s directory.</p>
<pre><code>cp ~/hakyll/data/example ~/myblog</code></pre>
<p>Now go to your <code>myblog</code> folder and instantiate a <code>hsenv</code> sandbox, and then install <code>hakyll</code> into this sandbox.</p>
<table class="sourceCode bash numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
</pre></td><td class="sourceCode"><pre><code class="sourceCode bash"><span class="kw">cd</span> ~/myblog
<span class="kw">~/.cabal/bin/hsenv</span>
<span class="kw">source</span> .hsenv_myblog/bin/activate
<span class="kw">cd</span> ~/hakyll
<span class="kw">cabal</span> install
<span class="kw">cd</span> ~/myblog</code></pre></td></tr></table>
<p>The <code>hsenv</code> basically changes your shell’s path parameters and also installs everything into the <code>.hsenv_myblog</code> folder, thus giving your shell a different “vision”, so to speak, of what packages are installed. We use the sandbox environment inside <code>hsenv</code> whenever we want to generate our blog’s static generator binary (remember, <code>hakyll</code> is just a library; we need to write a static site generator program that makes use of it to generate the static html/css).</p>
<p>To deactivate the sandbox, invoke <code>deactivate_hsenv</code> or just close your shell. Just remember to call <code>source .hsenv_myblog/bin/activate</code> when you want to make changes to your blog or edit your blog’s binary. A sample creating/edition session would look something like this:</p>
<table class="sourceCode bash numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="sourceCode"><pre><code class="sourceCode bash"><span class="kw">cd</span> ~/myblog
<span class="kw">source</span> .hsenv_myblog/bin/activate
<span class="co"># edit some files, including site.hs, the static generator binary</span>
<span class="co"># compile site.hs</span>
<span class="kw">./site</span> rebuild
<span class="kw">./site</span> preview
<span class="kw">...</span>
<span class="kw">deactivate_hsenv</span></code></pre></td></tr></table>
<p>Your static site will be available at <code>~/myblog/_site</code>.</p>
<h2 id="create-and-upload-your-site-to-github">Create and upload your site to GitHub</h2>
<p>At your GitHub site/account, create a repo named <code>username.github.io</code>. Now link it up with your static site:</p>
<table class="sourceCode bash numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
</pre></td><td class="sourceCode"><pre><code class="sourceCode bash"><span class="kw">cd</span> ~/myblog/_site
<span class="kw">git</span> init
<span class="kw">git</span> add *.html <span class="co"># add css, etc.</span>
<span class="kw">git</span> commit -m <span class="st">&quot;initial import&quot;</span>
<span class="kw">git</span> remote add origin https://github.com/username/username.github.io.git
<span class="kw">git</span> push -u origin master</code></pre></td></tr></table>
<h2 id="source">Source</h2>
<p>This site’s source code is available <a href="https://github.com/listx/listx_blog">here</a>. This site’s static code is available <a href="https://github.com/listx/listx.github.io">here</a>.</p>

		</div>
		<div id="footer">
			<a href="https://github.com/listx/listx_blog">Site</a>
			<a href="https://github.com/listx/listx.github.io">generated</a>
			with
			<a href="http://jaspervdj.be/hakyll">Hakyll</a>
			and
			<a href="http://sebastiaanvisser.github.com/clay">Clay</a>.
			<br>
			<a href="atom.xml">Atom feed</a>
		</div>
	</body>
</html>
