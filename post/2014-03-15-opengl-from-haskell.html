<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Linus's Blog - OpenGL from Haskell</title>
		<link rel="stylesheet" href="../css/base.css">
		<link rel="stylesheet" href="../css/syntax.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro">
		<link rel="shortcut icon" type="image/png" href="../favicon.png">
		<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
		<script src="../misc.js"></script>
		<!-- https://github.com/mreid/markreidname-hakyll/blob/master/_templates/mathjax.html -->
<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		extensions: ["tex2jax.js"],
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["\\(","\\)"] ],
			displayMath: [ ["\\[","\\]"] ],
			processEscapes: true
		},
		TeX: { equationNumbers: { autoNumber: "AMS" } },
		"HTML-CSS": { availableFonts: ["TeX"] }
	});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>

	</head>
	<body>
		<div id="header">
			<a href="../">Blog</a>
			&bull;
			<a href="../about.html">About</a>
			&bull;
			<a href="../papers.html">Papers</a>
		</div>

		<div id="content">
			<h1 class="center" id="page-title">OpenGL from Haskell</h1>

			<div class="info center">
	<code class="date">2014-03-15</code><a class="history" href="https://github.com/listx/listx_blog/commits/master/post/2014-03-15-opengl-from-haskell.md" title="History">*</a>
	<br>
	<a href="../tag/haskell.html">haskell</a>, <a href="../tag/opengl.html">opengl</a>
</div>

<p>The following is my translation/adaptation of <a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/">tutorial #2</a> at <a href="http://www.opengl-tutorial.org" class="uri">http://www.opengl-tutorial.org</a>. It draws a single red triangle on the screen with a dark blue background. It takes quite a bit of boilerplate code just to get something on the screen!</p>
<p>My version uses the code from <a href="https://github.com/YPares/Haskell-OpenGL3.1-Tutos" class="uri">https://github.com/YPares/Haskell-OpenGL3.1-Tutos</a>, but does not use <code>Control.Applicative</code> and also does not put the shaders containing GLSL in a separate text file. Everything is self-contained in one file, and it only uses the <code>PackageImports</code> and <code>RecordWildCards</code> GHC extensions. The <code>PackageImports</code> is only necessary if you have both <a href="http://hackage.haskell.org/package/GLFW">GLFW</a> and <a href="http://hackage.haskell.org/package/GLFW-b">GLFW-b</a> Hackage packages installed in your system (as they have a name clash of <code>Graphics.UI.GLFW</code>, you need to disambiguate this import by specifying the package name). The <code>RecordWildCards</code> extension is pretty standard and exists purely for syntactic sugar (no type-level hoops and such) — if you don’t know about it you should google it.</p>
<p>I went ahead and added type signatures for all top-level functions — something that many Haskell tutorial writers hate doing for some strange, unknown reason.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Also, I ran the code through <code>ghc --make -Wall</code> and silenced all warnings.</p>
<p>I hereby release it into the Public Domain. From what I can tell, YPares’s code doesn’t have a license… I think this should be OK.</p>
<div class="code-and-raw lineCntMax1000">
<div class="raw-link sourceCode">
<table class="sourceCode numberLines noPaddingBottom"><tbody><tr class="sourceCode"><td class="lineNumbers"><pre>&nbsp;&nbsp;■</pre></td><td class="sourceCode"><pre><code><a class="raw" href="../code/opengl/triangle.hs" mimetype="text/plain">triangle.hs</a></code></pre></td></tr></tbody></table>
</div>
<div class="sourceCode" id="cb1" data-input="code/opengl/triangle.hs"><pre class="sourceCode numberSource numberLines haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="ot">{-# LANGUAGE PackageImports #-}</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="ot">{-# LANGUAGE RecordWildCards #-}</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">import</span> <span class="dt">Control.Monad</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">import</span> <span class="dt">Data.Maybe</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">import</span> <span class="dt">Foreign</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">import</span> <span class="dt">Foreign.C.String</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">import</span> <span class="dt">Foreign.C.Types</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">import</span> <span class="kw">qualified</span> &quot;<span class="dt">GLFW</span>-b&quot; <span class="dt">Graphics.UI.GLFW</span> <span class="kw">as</span> <span class="dt">GLFW</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">import</span> <span class="dt">Graphics.Rendering.OpenGL.Raw</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">import</span> <span class="dt">System.Exit</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">data</span> <span class="dt">GLIDs</span> <span class="fu">=</span> <span class="dt">GLIDs</span></a>
<a class="sourceLine" id="cb1-15" title="15">  {<span class="ot"> progId ::</span> <span class="fu">!</span><span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-16" title="16">  ,<span class="ot"> vertexArrayId ::</span> <span class="fu">!</span><span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-17" title="17">  ,<span class="ot"> vertexBufferId ::</span> <span class="fu">!</span><span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-18" title="18">  }</a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="ot">withNewPtr ::</span> <span class="dt">Storable</span> b <span class="ot">=&gt;</span> (<span class="dt">Ptr</span> b <span class="ot">-&gt;</span> <span class="dt">IO</span> a) <span class="ot">-&gt;</span> <span class="dt">IO</span> b</a>
<a class="sourceLine" id="cb1-21" title="21">withNewPtr f <span class="fu">=</span> alloca (\p <span class="ot">-&gt;</span> f p <span class="fu">&gt;&gt;</span> peek p)</a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="ot">initialize ::</span> <span class="dt">IO</span> <span class="dt">GLFW.Window</span></a>
<a class="sourceLine" id="cb1-24" title="24">initialize <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-25" title="25">  ok <span class="ot">&lt;-</span> GLFW.init</a>
<a class="sourceLine" id="cb1-26" title="26">  when (<span class="fu">not</span> ok) <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-27" title="27">    _ <span class="ot">&lt;-</span> <span class="fu">fail</span> <span class="st">&quot;Failed to initialize GLFW&quot;</span></a>
<a class="sourceLine" id="cb1-28" title="28">    exitFailure</a>
<a class="sourceLine" id="cb1-29" title="29">  <span class="fu">mapM_</span> GLFW.windowHint</a>
<a class="sourceLine" id="cb1-30" title="30">    [ <span class="dt">GLFW.WindowHint'Samples</span> <span class="dv">4</span> <span class="co">-- 4x antialiasing</span></a>
<a class="sourceLine" id="cb1-31" title="31">    , <span class="dt">GLFW.WindowHint'ContextVersionMajor</span> <span class="dv">3</span> <span class="co">-- OpenGL 3.3</span></a>
<a class="sourceLine" id="cb1-32" title="32">    , <span class="dt">GLFW.WindowHint'ContextVersionMinor</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1-33" title="33">    <span class="co">-- we don't want the old OpenGL</span></a>
<a class="sourceLine" id="cb1-34" title="34">    , <span class="dt">GLFW.WindowHint'OpenGLProfile</span> <span class="dt">GLFW.OpenGLProfile'Core</span></a>
<a class="sourceLine" id="cb1-35" title="35">    ]</a>
<a class="sourceLine" id="cb1-36" title="36"></a>
<a class="sourceLine" id="cb1-37" title="37">  win <span class="ot">&lt;-</span> GLFW.createWindow <span class="dv">800</span> <span class="dv">600</span> <span class="st">&quot;Window Title&quot;</span> <span class="dt">Nothing</span> <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb1-38" title="38">  when (isNothing win) <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-39" title="39">    _ <span class="ot">&lt;-</span> <span class="fu">fail</span> <span class="st">&quot;Failed to create OpenGL window&quot;</span></a>
<a class="sourceLine" id="cb1-40" title="40">    GLFW.terminate</a>
<a class="sourceLine" id="cb1-41" title="41">    exitFailure</a>
<a class="sourceLine" id="cb1-42" title="42">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb1-43" title="43">    win' <span class="fu">=</span> fromJust win</a>
<a class="sourceLine" id="cb1-44" title="44">  GLFW.makeContextCurrent win</a>
<a class="sourceLine" id="cb1-45" title="45"></a>
<a class="sourceLine" id="cb1-46" title="46">  GLFW.setStickyKeysInputMode win' <span class="dt">GLFW.StickyKeysInputMode'Enabled</span></a>
<a class="sourceLine" id="cb1-47" title="47"></a>
<a class="sourceLine" id="cb1-48" title="48">  <span class="fu">return</span> win'</a>
<a class="sourceLine" id="cb1-49" title="49"></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="ot">initializeGL ::</span> <span class="dt">IO</span> <span class="dt">GLIDs</span></a>
<a class="sourceLine" id="cb1-51" title="51">initializeGL <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-52" title="52">  glClearColor <span class="dv">0</span> <span class="dv">0</span> <span class="fl">0.4</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-53" title="53">  progId <span class="ot">&lt;-</span> loadProgram vertexShader1 fragmentShader1</a>
<a class="sourceLine" id="cb1-54" title="54">  vaId <span class="ot">&lt;-</span> newVAO</a>
<a class="sourceLine" id="cb1-55" title="55">  bufId <span class="ot">&lt;-</span> fillNewBuffer vertexBufferData</a>
<a class="sourceLine" id="cb1-56" title="56">  <span class="fu">return</span> <span class="fu">$</span> <span class="dt">GLIDs</span></a>
<a class="sourceLine" id="cb1-57" title="57">    { progId <span class="fu">=</span> progId</a>
<a class="sourceLine" id="cb1-58" title="58">    , vertexArrayId <span class="fu">=</span> vaId</a>
<a class="sourceLine" id="cb1-59" title="59">    , vertexBufferId <span class="fu">=</span> bufId</a>
<a class="sourceLine" id="cb1-60" title="60">    }</a>
<a class="sourceLine" id="cb1-61" title="61"></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="ot">freeResources ::</span> <span class="dt">GLIDs</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb1-63" title="63">freeResources <span class="dt">GLIDs</span>{<span class="fu">..</span>} <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-64" title="64">  with vertexBufferId <span class="fu">$</span> glDeleteBuffers <span class="dv">1</span></a>
<a class="sourceLine" id="cb1-65" title="65">  with vertexArrayId <span class="fu">$</span> glDeleteVertexArrays <span class="dv">1</span></a>
<a class="sourceLine" id="cb1-66" title="66"></a>
<a class="sourceLine" id="cb1-67" title="67"><span class="ot">newVAO ::</span> <span class="dt">IO</span> <span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-68" title="68">newVAO <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-69" title="69">  vaId <span class="ot">&lt;-</span> withNewPtr (glGenVertexArrays <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-70" title="70">  glBindVertexArray vaId</a>
<a class="sourceLine" id="cb1-71" title="71">  <span class="fu">return</span> vaId</a>
<a class="sourceLine" id="cb1-72" title="72"></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="ot">fillNewBuffer ::</span> [<span class="dt">GLfloat</span>] <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-74" title="74">fillNewBuffer xs <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-75" title="75">  bufId <span class="ot">&lt;-</span> withNewPtr (glGenBuffers <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-76" title="76">  glBindBuffer gl_ARRAY_BUFFER bufId</a>
<a class="sourceLine" id="cb1-77" title="77">  withArrayLen xs func <span class="co">-- give given vertices to OpenGL</span></a>
<a class="sourceLine" id="cb1-78" title="78">  <span class="fu">return</span> bufId</a>
<a class="sourceLine" id="cb1-79" title="79">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-80" title="80">  func len ptr <span class="fu">=</span> glBufferData</a>
<a class="sourceLine" id="cb1-81" title="81">    gl_ARRAY_BUFFER</a>
<a class="sourceLine" id="cb1-82" title="82">    (<span class="fu">fromIntegral</span> (len <span class="fu">*</span> sizeOf (<span class="fu">undefined</span><span class="ot"> ::</span> <span class="dt">GLfloat</span>)))</a>
<a class="sourceLine" id="cb1-83" title="83">    (<span class="ot">ptr ::</span> <span class="dt">Ptr</span> <span class="dt">GLfloat</span>)</a>
<a class="sourceLine" id="cb1-84" title="84">    gl_STATIC_DRAW</a>
<a class="sourceLine" id="cb1-85" title="85"></a>
<a class="sourceLine" id="cb1-86" title="86"><span class="ot">bindBufferToAttrib ::</span> <span class="dt">GLuint</span> <span class="ot">-&gt;</span> <span class="dt">GLuint</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb1-87" title="87">bindBufferToAttrib bufId attribLoc <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-88" title="88">  glEnableVertexAttribArray attribLoc</a>
<a class="sourceLine" id="cb1-89" title="89">  glBindBuffer gl_ARRAY_BUFFER bufId</a>
<a class="sourceLine" id="cb1-90" title="90">  glVertexAttribPointer</a>
<a class="sourceLine" id="cb1-91" title="91">    attribLoc <span class="co">-- attribute location in the shader</span></a>
<a class="sourceLine" id="cb1-92" title="92">    <span class="dv">3</span> <span class="co">-- 3 components per vertex</span></a>
<a class="sourceLine" id="cb1-93" title="93">    gl_FLOAT <span class="co">-- coord type</span></a>
<a class="sourceLine" id="cb1-94" title="94">    (fromBool <span class="dt">False</span>) <span class="co">-- normalize?</span></a>
<a class="sourceLine" id="cb1-95" title="95">    <span class="dv">0</span> <span class="co">-- stride</span></a>
<a class="sourceLine" id="cb1-96" title="96">    nullPtr <span class="co">-- vertex buffer offset</span></a>
<a class="sourceLine" id="cb1-97" title="97"></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="ot">loadProgram ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-99" title="99">loadProgram vertShader fragShader <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-100" title="100">  shaderIds <span class="ot">&lt;-</span> <span class="fu">mapM</span> (<span class="fu">uncurry</span> loadShader)</a>
<a class="sourceLine" id="cb1-101" title="101">    [ (gl_VERTEX_SHADER, vertShader)</a>
<a class="sourceLine" id="cb1-102" title="102">    , (gl_FRAGMENT_SHADER, fragShader)</a>
<a class="sourceLine" id="cb1-103" title="103">    ]</a>
<a class="sourceLine" id="cb1-104" title="104">  progId <span class="ot">&lt;-</span> glCreateProgram</a>
<a class="sourceLine" id="cb1-105" title="105">  <span class="fu">putStrLn</span> <span class="st">&quot;Linking program&quot;</span></a>
<a class="sourceLine" id="cb1-106" title="106">  <span class="fu">mapM_</span> (glAttachShader progId) shaderIds</a>
<a class="sourceLine" id="cb1-107" title="107">  glLinkProgram progId</a>
<a class="sourceLine" id="cb1-108" title="108">  _ <span class="ot">&lt;-</span> checkStatus</a>
<a class="sourceLine" id="cb1-109" title="109">    gl_LINK_STATUS glGetProgramiv glGetProgramInfoLog progId</a>
<a class="sourceLine" id="cb1-110" title="110">  <span class="fu">mapM_</span> glDeleteShader shaderIds</a>
<a class="sourceLine" id="cb1-111" title="111">  <span class="fu">return</span> progId</a>
<a class="sourceLine" id="cb1-112" title="112"></a>
<a class="sourceLine" id="cb1-113" title="113"><span class="ot">loadShader ::</span> <span class="dt">GLenum</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">GLuint</span></a>
<a class="sourceLine" id="cb1-114" title="114">loadShader shaderTypeFlag code <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-115" title="115">  shaderId <span class="ot">&lt;-</span> glCreateShader shaderTypeFlag</a>
<a class="sourceLine" id="cb1-116" title="116">  withCString code <span class="fu">$</span> \codePtr <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb1-117" title="117">    with codePtr <span class="fu">$</span> \codePtrPtr <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb1-118" title="118">      glShaderSource shaderId <span class="dv">1</span> codePtrPtr nullPtr</a>
<a class="sourceLine" id="cb1-119" title="119">  <span class="fu">putStrLn</span> <span class="st">&quot;Compiling shader...&quot;</span></a>
<a class="sourceLine" id="cb1-120" title="120">  glCompileShader shaderId</a>
<a class="sourceLine" id="cb1-121" title="121">  _ <span class="ot">&lt;-</span> checkStatus</a>
<a class="sourceLine" id="cb1-122" title="122">    gl_COMPILE_STATUS glGetShaderiv glGetShaderInfoLog shaderId</a>
<a class="sourceLine" id="cb1-123" title="123">  <span class="fu">return</span> shaderId</a>
<a class="sourceLine" id="cb1-124" title="124"></a>
<a class="sourceLine" id="cb1-125" title="125"><span class="ot">checkStatus ::</span> (<span class="dt">Integral</span> a1, <span class="dt">Storable</span> a1)</a>
<a class="sourceLine" id="cb1-126" title="126">  <span class="ot">=&gt;</span> <span class="dt">GLenum</span></a>
<a class="sourceLine" id="cb1-127" title="127">  <span class="ot">-&gt;</span> (t <span class="ot">-&gt;</span> <span class="dt">GLenum</span> <span class="ot">-&gt;</span> <span class="dt">Ptr</span> a1 <span class="ot">-&gt;</span> <span class="dt">IO</span> a)</a>
<a class="sourceLine" id="cb1-128" title="128">  <span class="ot">-&gt;</span> (t <span class="ot">-&gt;</span> a1 <span class="ot">-&gt;</span> <span class="dt">Ptr</span> a3 <span class="ot">-&gt;</span> <span class="dt">Ptr</span> <span class="dt">Foreign.C.Types.CChar</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> a2)</a>
<a class="sourceLine" id="cb1-129" title="129">  <span class="ot">-&gt;</span> t</a>
<a class="sourceLine" id="cb1-130" title="130">  <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-131" title="131">checkStatus statusFlag glGetFn glInfoLogFn componentId <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-132" title="132">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb1-133" title="133">    fetch info <span class="fu">=</span> withNewPtr (glGetFn componentId info)</a>
<a class="sourceLine" id="cb1-134" title="134">  status <span class="ot">&lt;-</span> liftM toBool <span class="fu">$</span> fetch statusFlag</a>
<a class="sourceLine" id="cb1-135" title="135">  logLength <span class="ot">&lt;-</span> fetch gl_INFO_LOG_LENGTH</a>
<a class="sourceLine" id="cb1-136" title="136">  when (logLength <span class="fu">&gt;</span> <span class="dv">0</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb1-137" title="137">    allocaArray0 (<span class="fu">fromIntegral</span> logLength) <span class="fu">$</span> \msgPtr <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-138" title="138">      _ <span class="ot">&lt;-</span> glInfoLogFn componentId logLength nullPtr msgPtr</a>
<a class="sourceLine" id="cb1-139" title="139">      msg <span class="ot">&lt;-</span> peekCString msgPtr</a>
<a class="sourceLine" id="cb1-140" title="140">      (<span class="kw">if</span> status <span class="kw">then</span> <span class="fu">putStrLn</span> <span class="kw">else</span> <span class="fu">fail</span>) msg</a>
<a class="sourceLine" id="cb1-141" title="141">  <span class="fu">return</span> status</a>
<a class="sourceLine" id="cb1-142" title="142"></a>
<a class="sourceLine" id="cb1-143" title="143"><span class="ot">fragmentShader1 ::</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-144" title="144">fragmentShader1 <span class="fu">=</span> <span class="fu">unlines</span></a>
<a class="sourceLine" id="cb1-145" title="145">  [ <span class="st">&quot;#version 330 core&quot;</span></a>
<a class="sourceLine" id="cb1-146" title="146">  , <span class="st">&quot;out vec3 color;&quot;</span></a>
<a class="sourceLine" id="cb1-147" title="147">  , <span class="st">&quot;void main()&quot;</span></a>
<a class="sourceLine" id="cb1-148" title="148">  , <span class="st">&quot;{&quot;</span></a>
<a class="sourceLine" id="cb1-149" title="149">    , <span class="st">&quot;color =  vec3(1,0,0);&quot;</span> <span class="co">-- paint it red!</span></a>
<a class="sourceLine" id="cb1-150" title="150">  , <span class="st">&quot;}&quot;</span></a>
<a class="sourceLine" id="cb1-151" title="151">  ]</a>
<a class="sourceLine" id="cb1-152" title="152"></a>
<a class="sourceLine" id="cb1-153" title="153"><span class="ot">vertexShader1 ::</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-154" title="154">vertexShader1 <span class="fu">=</span> <span class="fu">unlines</span></a>
<a class="sourceLine" id="cb1-155" title="155">  [ <span class="st">&quot;#version 330 core&quot;</span></a>
<a class="sourceLine" id="cb1-156" title="156">  , <span class="st">&quot;layout(location = 0) in vec3 vPosition_modelspace;&quot;</span></a>
<a class="sourceLine" id="cb1-157" title="157">  , <span class="st">&quot;void main()&quot;</span></a>
<a class="sourceLine" id="cb1-158" title="158">  , <span class="st">&quot;{&quot;</span></a>
<a class="sourceLine" id="cb1-159" title="159">    , <span class="st">&quot;gl_Position.xyz = vPosition_modelspace;&quot;</span></a>
<a class="sourceLine" id="cb1-160" title="160">    , <span class="st">&quot;gl_Position.w = 1.0;&quot;</span></a>
<a class="sourceLine" id="cb1-161" title="161">  , <span class="st">&quot;}&quot;</span></a>
<a class="sourceLine" id="cb1-162" title="162">  ]</a>
<a class="sourceLine" id="cb1-163" title="163"></a>
<a class="sourceLine" id="cb1-164" title="164"></a>
<a class="sourceLine" id="cb1-165" title="165"><span class="ot">vertexBufferData ::</span> [<span class="dt">GLfloat</span>]</a>
<a class="sourceLine" id="cb1-166" title="166">vertexBufferData <span class="fu">=</span></a>
<a class="sourceLine" id="cb1-167" title="167">  <span class="co">-- x, y, z</span></a>
<a class="sourceLine" id="cb1-168" title="168">  [ <span class="fu">-</span><span class="dv">1</span>, <span class="fu">-</span><span class="dv">1</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-169" title="169">  ,  <span class="dv">1</span>, <span class="fu">-</span><span class="dv">1</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-170" title="170">  ,  <span class="dv">0</span>,  <span class="dv">1</span>, <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-171" title="171">  ]</a>
<a class="sourceLine" id="cb1-172" title="172"></a>
<a class="sourceLine" id="cb1-173" title="173"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb1-174" title="174">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-175" title="175">  win <span class="ot">&lt;-</span> initialize</a>
<a class="sourceLine" id="cb1-176" title="176">  glids <span class="ot">&lt;-</span> initializeGL</a>
<a class="sourceLine" id="cb1-177" title="177">  inputLoop win glids</a>
<a class="sourceLine" id="cb1-178" title="178">  freeResources glids</a>
<a class="sourceLine" id="cb1-179" title="179">  GLFW.terminate</a>
<a class="sourceLine" id="cb1-180" title="180">  <span class="fu">return</span> ()</a>
<a class="sourceLine" id="cb1-181" title="181"></a>
<a class="sourceLine" id="cb1-182" title="182"><span class="ot">inputLoop ::</span> <span class="dt">GLFW.Window</span> <span class="ot">-&gt;</span> <span class="dt">GLIDs</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb1-183" title="183">inputLoop win glids <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-184" title="184">  drawStuff glids</a>
<a class="sourceLine" id="cb1-185" title="185">  GLFW.swapBuffers win</a>
<a class="sourceLine" id="cb1-186" title="186">  GLFW.pollEvents</a>
<a class="sourceLine" id="cb1-187" title="187">  keyState <span class="ot">&lt;-</span> GLFW.getKey win <span class="dt">GLFW.Key'Escape</span></a>
<a class="sourceLine" id="cb1-188" title="188">  closeWindow <span class="ot">&lt;-</span> GLFW.windowShouldClose win</a>
<a class="sourceLine" id="cb1-189" title="189">  when (keyState <span class="fu">/=</span> <span class="dt">GLFW.KeyState'Pressed</span> <span class="fu">&amp;&amp;</span> closeWindow <span class="fu">==</span> <span class="dt">False</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb1-190" title="190">    inputLoop win glids</a>
<a class="sourceLine" id="cb1-191" title="191"></a>
<a class="sourceLine" id="cb1-192" title="192"><span class="ot">drawStuff ::</span> <span class="dt">GLIDs</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb1-193" title="193">drawStuff <span class="dt">GLIDs</span>{<span class="fu">..</span>} <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-194" title="194">  glClear gl_COLOR_BUFFER_BIT</a>
<a class="sourceLine" id="cb1-195" title="195">  glClear gl_DEPTH_BUFFER_BIT</a>
<a class="sourceLine" id="cb1-196" title="196">  glUseProgram progId</a>
<a class="sourceLine" id="cb1-197" title="197">  bindBufferToAttrib vertexBufferId <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-198" title="198">  glDrawArrays gl_TRIANGLES <span class="dv">0</span> <span class="dv">3</span> <span class="co">-- for attrib array 0, draw 3 vertices</span></a>
<a class="sourceLine" id="cb1-199" title="199">  glDisableVertexAttribArray <span class="dv">0</span> <span class="co">-- disable attrib array 0</span></a></code></pre></div>
</div>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Seriously, why do so many Haskell tutorials omit function type signatures?<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</section>

		</div>
		<div id="footer">
			<p>Copyright (C) 2013-2021 Linus Arver. All rights reserved.</p>
			<a href="https://github.com/listx/listx_blog">Site</a>
			<a href="https://github.com/listx/listx.github.io">generated</a>
			with
			<a href="https://jaspervdj.be/hakyll">Hakyll</a>
			and
			<a href="http://sebastiaanvisser.github.com/clay">Clay</a>.
			<br>
			<a href="../atom.xml">Atom feed</a>
		</div>
	</body>
</html>
